/**
 * ngScrollable - Superamazing scrollbars for AngularJS
 * @version 0.1.0 - built on 2014-07-11
 * @link 
 * @license MIT License, Copyright (c) 2014 Alexander Eichhorn <alex@kidtsunami.com>
 */
angular.module("ngScrollable",[]).directive("ngScrollable",["$document","$window","$timeout",function(a,b,c){"use strict";var d={scrollX:"bottom",scrollY:"right",scrollXSlackSpace:0,scrollYSlackSpace:0,wheelSpeed:1,minSliderLength:10,useBothWheelAxes:!1,useKeyboard:!0,updateOnResize:!0};return{restrict:"A",replace:!0,transclude:!0,template:"<div class=\"scrollable\"><div class=\"scrollable-content\" ng-transclude></div><div class='scrollable-bar scrollable-bar-x'><div class='scrollable-slider'></div></div><div class='scrollable-bar scrollable-bar-y'><div class='scrollable-slider'></div></div></div>",link:function(e,f,g){var h,i=angular.extend({},d,e.$eval(g.ngScrollable)),j={window:angular.element(b),content:angular.element(f.children()[0]),barX:angular.element(f.children()[1]),barY:angular.element(f.children()[2]),sliderX:angular.element(angular.element(f.children()[1]).children()[0]),sliderY:angular.element(angular.element(f.children()[2]).children()[0])},k=!1,l=!1,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=null,x=null,y=null,z=null,A=!1,B=!1,C=!1,D=function(a){return a.toFixed(3)+"px"},E=function(a,b,c){return Math.max(b,Math.min(a,c))},F=function(){var a;k?(s=Math.max(i.minSliderLength,parseInt(m*m/o,10)),t=parseInt(r*(m-s)/(o-m),10),t>=m-s?t=m-s:0>t&&(t=0),a="translate("+D(t)+",0)",j.sliderX.css({transform:a,"-webkit-transform":a,width:D(s)})):(s=t=0,a="translate(0,0)",j.sliderX.css({transform:a,"-webkit-transform":a,width:0}))},G=function(){var a;l?(u=Math.max(i.minSliderLength,parseInt(n*n/p,10)),v=parseInt(q*(n-u)/(p-n),10),v>=n-u?v=n-u:0>v&&(v=0),a="translate(0,"+D(v)+")",j.sliderY.css({transform:a,"-webkit-transform":a,height:D(u)})):(v=u=0,a="translate(0,0)",j.sliderY.css({transform:a,"-webkit-transform":a,height:0}))},H=function(){var a={left:0,width:D(m),display:k?"inherit":"none"};switch(i.scrollX){case"bottom":a.bottom=0,j.content[k?"addClass":"removeClass"]("scrollable-bottom");break;case"top":a.top=0,j.content[k?"addClass":"removeClass"]("scrollable-top")}j.barX.css(a)},I=function(){var a={top:0,height:D(n),display:l?"inherit":"none"};switch(i.scrollY){case"right":a.right=0,j.content[l?"addClass":"removeClass"]("scrollable-right");break;case"left":a.left=0,j.content[l?"addClass":"removeClass"]("scrollable-left")}j.barY.css(a)},J=function(a,b){q=E(b,0,p-n),r=E(a,0,o-m);var c="translate("+D(-r)+","+D(-q)+")";j.content.css({transform:c,"-webkit-transform":c})},K=function(a){J(a,q),F()},L=function(a){J(r,a),G()},M=function(){m=f[0].offsetWidth,n=f[0].offsetHeight,o=j.content[0].scrollWidth,p=j.content[0].scrollHeight,"none"!==i.scrollX&&o>m+i.scrollXSlackSpace?k=!0:(k=!1,K(0)),"none"!==i.scrollY&&p>n+i.scrollYSlackSpace?l=!0:(l=!1,L(0)),H(),I(),F(),G()},N=function(a,b){a.stopPropagation(),b&&a.preventDefault()},O=function(a){x=a.pageX,w=r,A=!0,f.addClass("active"),N(a,!0)},P=function(a){if(A){var b=a.pageX-x,c=parseInt(b*(o-m)/(m-s),10);K(w+c),N(a,!0)}},Q=function(){A&&(A=!1,f.removeClass("active"),w=x=null)},R=function(a){z=a.pageY,y=q,B=!0,f.addClass("active"),N(a,!0)},S=function(a){if(B){var b=a.pageY-z,c=parseInt(b*(p-n)/(n-u),10);L(y+c),N(a,!0)}},T=function(){B&&(B=!1,f.removeClass("active"),y=z=null)},U=function(a){var b=parseInt(s/2,10),c=a.clientX-j.barX[0].getBoundingClientRect().left-b,d=m-s,e=E(c/d,0,1);K((o-m)*e)},V=function(a){var b=parseInt(u/2,10),c=a.clientY-j.barY[0].getBoundingClientRect().top-b,d=n-u,e=E(c/d,0,1);L((p-n)*e)},W=function(){C=!0},X=function(){C=!1},Y=function(b){var c=0,d=0,e=30;if(!(!C||a[0].activeElement.isContentEditable||b.altKey||b.ctrlKey||b.metaKey)){switch(b.which){case 37:c=-e;break;case 38:d=e;break;case 39:c=e;break;case 40:d=-e;break;case 33:d=n;break;case 32:case 34:d=-n;break;case 35:l&&!k?d=-p:c=n;break;case 36:l&&!k?d=p:c=-n;break;default:return}L(q-d),K(r+c),b.preventDefault()}},Z=function(a){a=a.originalEvent||a;var b=(angular.isDefined(a.wheelDeltaX)?-a.wheelDeltaX:a.deltaX)*i.wheelSpeed,d=(angular.isDefined(a.wheelDeltaY)?-a.wheelDeltaY:a.deltaY)*i.wheelSpeed;f.addClass("active"),c.cancel(h),h=c(function(){f.removeClass("active")},500),i.useBothWheelAxes?l&&!k?L(d?q+d:q+b):k&&!l&&K(b?r+b:r+d):(L(q+d),K(r+b)),M(),N(a,!0)};M(),e.$on("content.changed",function(){c(function(){j.content=angular.element(f.children()[0]),M()})}),i.updateOnResize&&j.window.on("resize",M),j.sliderX.on("click",N),j.barX.on("click",U),j.sliderY.on("click",N),j.barY.on("click",V),j.sliderX.on("mousedown",O),a.on("mousemove",P),a.on("mouseup",Q),j.sliderY.on("mousedown",R),a.on("mousemove",S),a.on("mouseup",T),f.on("mouseenter",W),f.on("mouseleave",X),a.on("keydown",Y),f.on("wheel",Z),f.on("mousewheel",Z),e.$on("$destroy",function(){c.cancel(h),i.updateOnResize&&j.window.off("resize",M),j.sliderX.off("click",N),j.barX.off("click",U),j.sliderY.off("click",N),j.barY.off("click",V),j.sliderX.off("mousedown",O),a.off("mousemove",P),a.off("mouseup",Q),j.sliderY.off("mousedown",R),a.off("mousemove",S),a.off("mouseup",T),f.off("mouseenter",W),f.off("mouseleave",X),a.off("keydown",Y),f.off("wheel",Z),f.off("mousewheel",Z)})}}}]);